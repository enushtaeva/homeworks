@using ClassLibrary1
@model List<Statistic>
@{
    ViewBag.Title = "Статистика";
}
<br />
<br />
<h1 class="starter-template" style="text-align:center">Статистика из файла JSON</h1>
<br />
<br />
<table class="table" id="mt">
    <tr>
        <th>Логин</th>
        <th>Количество побед</th>
        <th>Количество ничьих</th>
        <th>Количество поражений</th>
    </tr>
    @foreach (Statistic user in Model)
    {
        <tr>
            <td>@user.Login</td>
            <td>@user.Win</td>
            <td>@user.NF</td>
            <td>@user.Won</td>
        </tr>
    }
</table>
<br />
<br />
<p style="text-align:center">@Html.ActionLink("Статистика по заданию","StatsOnTask")</p>
@section scripts {

<script src="~/Scripts/jquery.signalR-2.2.2.min.js"></script>
<!--Reference the autogenerated SignalR hub script. -->
<script src="~/signalr/hubs"></script>
<script type="text/javascript">
    var chat = $.connection.statisticHub;
    // Create a function that the hub can call to broadcast messages.
    chat.client.updateStatistic = function (data) {
        $("#mt tbody").find("tr:gt(0)").remove();
       var data1 = JSON.parse(data);
        for(var t=0;t<data1.length;t++){
            var tr = document.createElement("tr");
            var td = document.createElement("td");
            td.innerHTML = data1[t].login;
            tr.appendChild(td);
            td = document.createElement("td");
            td.innerHTML = data1[t].win;
            tr.appendChild(td);
            td = document.createElement("td");
            td.innerHTML = data1[t].nf;
            tr.appendChild(td);
            td = document.createElement("td");
            td.innerHTML = data1[t].won;
            tr.appendChild(td);
            $("#mt tbody").append(tr);
        }
    
    }
    $.connection.hub.start().done(function () {
    })
    </script>

}


